<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>React UI with D3</title>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css" />
  <script src="https://code.jquery.com/jquery-2.1.3.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.min.js"></script>

  <link rel="stylesheet" href="public/css/style.css">
  <link rel="stylesheet" href="public/css/griddle.css">
  <link href="public/css/nv.d3.css" rel="stylesheet">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.2/d3.min.js" charset="utf-8"></script>
  <script src="public/js/nv.d3.js"></script>
  <script data-main="build/main" src="scripts/require.js"></script>
</head>
<body>
  <div id="routed" class="container">
    <nav class="navbar nav-default">
    <div id="menu" class="container-fluid">
    </div>
    </nav>
    <div id="current-time"></div>
    <div id="app-time"></div>
    <div id="server-time"></div>
    <div id="chart"></div>
    <div id="bar-graph"></div>
    <div id="graph"></div>
    <div id="graphStack"></div>
    <div id="test1">
    <svg></svg>
</div>
  </div>
  <script src="build/main.js"></script>

  <script type="text/javascript" charset="utf-8">
  function generateData ( ) {
    var numberOfPoints = 20,
        graphData = [],
        series,
        i, j;

    for (i = 0; i < 3; i++) {
      series = [];
      for (j = 0; j < numberOfPoints; j++) {
        series.push({x: j, y: ((i+1) * j)});
      }
      graphData.push({ values: series})
    }

    return graphData;
  }


function stream_layers(n, m, o) {
  if (arguments.length < 3) o = 0;
  function bump(a) {
    var x = 1 / (.1 + Math.random()),
        y = 2 * Math.random() - .5,
        z = 10 / (.1 + Math.random());
    for (var i = 0; i < m; i++) {
      var w = (i / m - y) * z;
      a[i] += x * Math.exp(-w * w);
    }
  }
  return d3.range(n).map(function() {
      var a = [], i;
      for (i = 0; i < m; i++) a[i] = o + o * Math.random();
      for (i = 0; i < 5; i++) bump(a);
      return a.map(stream_index);
    });
}

function stream_waves(n, m) {
  return d3.range(n).map(function(i) {
    return d3.range(m).map(function(j) {
        var x = 20 * j / m - i / 3;
        return 2 * x * Math.exp(-.5 * x);
      }).map(stream_index);
    });
}

function stream_index(d, i) {
  return {x: i, y: Math.max(0, d)};
}


  //var test_data = stream_layers(3,128,.1).map(function(data, i) {
  var test_data = stream_layers(3,128,.1).map(function(data, i) {
      return {
          key: 'Stream' + i,
          values: data
      };
  });
  nv.addGraph({
      generate: function() {
          var width = nv.utils.windowSize().width,
              height = nv.utils.windowSize().height;
          var chart = nv.models.multiBarChart()
              .width(width)
              .height(height)
              .stacked(true)
              ;
          chart.dispatch.on('renderEnd', function(){
              console.log('Render Complete');
          });
          var svg = d3.select('#test1 svg').datum(test_data);
          console.log('calling chart');
          svg.transition().duration(0).call(chart);
          return chart;
      },
      callback: function(graph) {
          nv.utils.windowResize(function() {
              var width = nv.utils.windowSize().width;
              var height = nv.utils.windowSize().height;
              graph.width(width).height(height);
              d3.select('#test1 svg')
                  .attr('width', width)
                  .attr('height', height)
                  .transition().duration(0)
                  .call(graph);
          });
      }
  });
  </script>
</body>
</html>
